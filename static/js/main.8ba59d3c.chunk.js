(this["webpackJsonpreact-chess"]=this["webpackJsonpreact-chess"]||[]).push([[0],[,,,,,,,,,,,,,,,,function(e,t,n){e.exports=n(29)},,,,,function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},,function(e,t,n){},function(e,t,n){},function(e,t,n){"use strict";n.r(t);var i,o=n(0),r=n.n(o),a=n(11),c=n.n(a),s=(n(21),n(6)),u=(n(22),n(23),n(12)),l=n.n(u),h=(n(24),function(e){var t=e.position,n=e.selected,i=e.available,a=e.children,c=e.onClick,s=Object(o.useCallback)((function(){i&&c(t)}),[t,i,c]),u=(t.x+t.y)%2===0?"black":"white";return r.a.createElement("div",{className:l()("cell","cell_".concat(u),{cell_selected:n,cell_available:i}),title:t.code,onClick:s},a)}),v=(n(25),{king:"\u265a",queen:"\u265b",rook:"\u265c",bishop:"\u265d",knight:"\u265e",pawn:"\u265f\ufe0e"}),f=Object(s.a)((function(e){var t=e.piece,n=e.onSelect,i=Object(o.useCallback)((function(){n(t.selected?null:t)}),[t,n]);return r.a.createElement("div",{className:"piece piece_".concat(t.color),onClick:i},v[t.name])})),p=Object(s.a)((function(e){var t,n=e.board,i=e.selectedPiece,a=e.onPieceSelect,c=e.onPieceMove,s=null!==(t=null===i||void 0===i?void 0:i.getAvailableMoves(n))&&void 0!==t?t:[],u=Object(o.useCallback)((function(e){c(i,e)}),[c,i]);return r.a.createElement("div",{className:"board"},r.a.createElement("div",{className:"board__columns"},n.columns.map((function(e){return r.a.createElement("div",{key:e,className:"board__column"},e)}))),r.a.createElement("div",{className:"board__rows"},n.rows.map((function(e){return r.a.createElement("div",{key:e,className:"board__row"},e)}))),r.a.createElement("div",{className:"board__desk"},n.cells.map((function(e){var t=n.get(e);return r.a.createElement(h,{key:e.code,position:e,selected:i===t,available:!!s.find((function(t){return t.code===e.code})),onClick:u},t&&r.a.createElement(f,{piece:t,onSelect:a}))}))))}));!function(e){e.None="none",e.Check="check",e.Checkmate="checkmate",e.Stalemate="stalemate"}(i||(i={}));var d,g=i,b=(n(27),n(2)),m=n(3),k=n(7);!function(e){e[e.Left=1]="Left",e[e.Up=2]="Up",e[e.Right=4]="Right",e[e.Down=7]="Down",e[e.LeftUp=3]="LeftUp",e[e.LeftDown=8]="LeftDown",e[e.RightUp=6]="RightUp",e[e.RightDown=11]="RightDown"}(d||(d={}));var w,y=d,O=function(){function e(t){Object(b.a)(this,e),this.code=void 0,this.x=void 0,this.y=void 0,this.code=t;var n=e.toXY(t),i=Object(k.a)(n,2);this.x=i[0],this.y=i[1]}return Object(m.a)(e,[{key:"isOK",value:function(e){return this.x>=0&&this.x<e.width&&this.y>=0&&this.y<e.height}},{key:"to",value:function(e){switch(e){case y.Up:return this.up();case y.Down:return this.down();case y.Left:return this.left();case y.Right:return this.right();case y.LeftUp:return this.left().up();case y.LeftDown:return this.left().down();case y.RightUp:return this.right().up();case y.RightDown:return this.right().down()}}},{key:"up",value:function(){return e.fromXY(this.x,this.y+1)}},{key:"down",value:function(){return e.fromXY(this.x,this.y-1)}},{key:"left",value:function(){return e.fromXY(this.x-1,this.y)}},{key:"right",value:function(){return e.fromXY(this.x+1,this.y)}},{key:"toString",value:function(){return this.code}}],[{key:"toXY",value:function(e){return[e.charCodeAt(0)-"A".charCodeAt(0),e.charCodeAt(1)-"1".charCodeAt(0)]}},{key:"toCode",value:function(t,n){var i=e.toColumn(t),o=e.toRow(n);return"".concat(i).concat(o)}},{key:"toColumn",value:function(e){return String.fromCharCode(e+"A".charCodeAt(0))}},{key:"toRow",value:function(e){return String.fromCharCode(e+"1".charCodeAt(0))}},{key:"fromXY",value:function(t,n){var i=e.toCode(t,n);return new e(i)}}]),e}();!function(e){e.White="white",e.Black="black"}(w||(w={}));var j=function(){function e(t,n){Object(b.a)(this,e),this.position=void 0,this.color=void 0,this.selected=!1,this.position="string"===typeof t?new O(t):t,this.color=n}return Object(m.a)(e,[{key:"getAvailableMoves",value:function(e){var t=this;return this.getAllMoves(e).filter((function(n){var i=e.copy();return i.set(n,t),!i.kingIsAttacked(t.color)}))}},{key:"isOpponent",value:function(e){return this.color!==e.color}},{key:"canMove",value:function(e,t){if(!e.isOK(t))return!1;var n=t.get(e);return!n||n.isOpponent(this)}},{key:"getMovesTowards",value:function(e,t){for(var n,i=[],o=this.position.to(e);!n&&o.isOK(t);)this.canMove(o,t)&&i.push(o),n=t.get(o),o=o.to(e);return i}}]),e}(),C=n(1),E=n(5),A=n(4),S=function(e){Object(E.a)(n,e);var t=Object(A.a)(n);function n(){return Object(b.a)(this,n),t.apply(this,arguments)}return Object(m.a)(n,[{key:"getAllMoves",value:function(e){for(var t=[],n=0,i=[y.LeftUp,y.LeftDown,y.RightUp,y.RightDown];n<i.length;n++){var o=i[n];t=t.concat(this.getMovesTowards(o,e))}return t}},{key:"name",get:function(){return"bishop"}}]),n}(j);Object(C.i)(S,{position:C.n,color:C.n});var B=S,M=function(e){Object(E.a)(n,e);var t=Object(A.a)(n);function n(){return Object(b.a)(this,n),t.apply(this,arguments)}return Object(m.a)(n,[{key:"getAllMoves",value:function(e){for(var t=[],n=0,i=[this.position.up().left().left(),this.position.up().right().right(),this.position.down().left().left(),this.position.down().right().right(),this.position.up().up().left(),this.position.up().up().right(),this.position.down().down().left(),this.position.down().down().right()];n<i.length;n++){var o=i[n];this.canMove(o,e)&&t.push(o)}return t}},{key:"name",get:function(){return"knight"}}]),n}(j);Object(C.i)(M,{position:C.n,color:C.n});var W=M,_=function(e){Object(E.a)(n,e);var t=Object(A.a)(n);function n(){return Object(b.a)(this,n),t.apply(this,arguments)}return Object(m.a)(n,[{key:"getAllMoves",value:function(e){for(var t=[],n=0,i=[y.Left,y.Right,y.Up,y.Down,y.LeftUp,y.LeftDown,y.RightUp,y.RightDown];n<i.length;n++){var o=i[n];t=t.concat(this.getMovesTowards(o,e))}return t}},{key:"name",get:function(){return"queen"}}]),n}(j);Object(C.i)(_,{position:C.n,color:C.n});var D=_,P=function(e){Object(E.a)(n,e);var t=Object(A.a)(n);function n(){return Object(b.a)(this,n),t.apply(this,arguments)}return Object(m.a)(n,[{key:"getAllMoves",value:function(e){for(var t=[],n=0,i=[y.Left,y.Right,y.Up,y.Down];n<i.length;n++){var o=i[n];t=t.concat(this.getMovesTowards(o,e))}return t}},{key:"name",get:function(){return"rook"}}]),n}(j);Object(C.i)(P,{position:C.n,color:C.n});var R=P,L=(n(28),new O("A1")),N=new D(L,w.Black),U=new D(L,w.White),T=new O("A2"),x=new W(T,w.Black),X=new W(T,w.White),Y=new O("A3"),K=new R(Y,w.Black),I=new R(Y,w.White),F=new O("A4"),q=new B(F,w.Black),G=new B(F,w.White),H=function(e){var t=e.color,n=e.onSelect,i=Object(o.useCallback)((function(){n(D)}),[n]),a=Object(o.useCallback)((function(){n(W)}),[n]),c=Object(o.useCallback)((function(){n(R)}),[n]),s=Object(o.useCallback)((function(){n(B)}),[n]);return r.a.createElement("dialog",{open:!0,className:"promotion-dialog"},"Select promotion:",r.a.createElement("div",{className:"promotion-dialog__chooses"},r.a.createElement(h,{position:L,onClick:i},r.a.createElement(f,{piece:t===w.Black?N:U,onSelect:i})),r.a.createElement(h,{position:T,onClick:a},r.a.createElement(f,{piece:t===w.Black?x:X,onSelect:a})),r.a.createElement(h,{position:Y,onClick:c},r.a.createElement(f,{piece:t===w.Black?K:I,onSelect:c})),r.a.createElement(h,{position:F,onClick:s},r.a.createElement(f,{piece:t===w.Black?q:G,onSelect:s}))))},J=Object(s.a)((function(e){var t=e.game,n=Object(o.useCallback)((function(e){t.select(e)}),[t]),i=Object(o.useCallback)((function(e,n){t.move(e,n)}),[t]),a=Object(o.useCallback)((function(e){t.promotePawn(e)}),[t]);return r.a.createElement("main",{className:"game"},r.a.createElement(p,{board:t.board,selectedPiece:t.selectedPiece,onPieceSelect:n,onPieceMove:i}),r.a.createElement("div",{className:"game__status"},t.boardStatus!==g.None?t.boardStatus.toString():""),r.a.createElement("div",{className:"game__winner"},t.isOver?t.winner?r.a.createElement(r.a.Fragment,null,r.a.createElement("span",{className:"game__winner__color"},"$",t.winner)," is the winner."):"Draw":""),t.promoting&&r.a.createElement(H,{color:t.promoting.color,onSelect:a}))})),$=n(14),z=function(e){Object(E.a)(n,e);var t=Object(A.a)(n);function n(){return Object(b.a)(this,n),t.apply(this,arguments)}return Object(m.a)(n,[{key:"getAllMoves",value:function(e){for(var t=[],n=0,i=[y.Left,y.Right,y.Up,y.Down,y.LeftUp,y.LeftDown,y.RightUp,y.RightDown];n<i.length;n++){var o=i[n],r=this.position.to(o);this.canMove(r,e)&&t.push(r)}return t}},{key:"getAvailableMoves",value:function(e){var t=this;return this.getAllMoves(e).filter((function(n){var i=e.copy();return i.set(n,t),!i.kingIsAttacked(t.color,n)}))}},{key:"name",get:function(){return"king"}}]),n}(j),Q=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:8,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:8;Object(b.a)(this,e),this.width=t,this.height=n,this.board=void 0,this.board=new Map}return Object(m.a)(e,[{key:"get",value:function(e){var t;return t=e instanceof O?e.code:e,this.board.get(t)}},{key:"move",value:function(e,t){var n;n=t instanceof O?t:new O(t),this.set(n,e),e.position=n}},{key:"put",value:function(e){this.set(e.position,e)}},{key:"set",value:function(e,t){var n;if(n=e instanceof O?e.code:e,t){var i=this.board.get(t.position.code);i===t&&this.board.delete(i.position.code),this.board.set(n,t)}else this.board.delete(n)}},{key:"copy",value:function(){var t,n=new e,i=Object($.a)(this.board.entries());try{for(i.s();!(t=i.n()).done;){var o=Object(k.a)(t.value,2),r=o[0],a=o[1];n.set(r,a)}}catch(c){i.e(c)}finally{i.f()}return n}},{key:"kingIsAttacked",value:function(e,t){var n,i,o=this;t?n=this.get(t):(n=this.pieces.find((function(t){return t instanceof z&&t.color===e})),t=null===(i=n)||void 0===i?void 0:i.position);if(!n)throw new Error("King was not found.");return this.pieces.filter((function(n){return n.color!==e&&n.getAllMoves(o).find((function(e){return e.code===t.code}))})).length>0}},{key:"checkmate",value:function(e){var t=this;if(!this.kingIsAttacked(e))return this.pieces.some((function(n){return n.color===e&&n.getAvailableMoves(t).length>0}))?g.None:g.Stalemate;var n=this.pieces.find((function(t){return t instanceof z&&t.color===e}));return n.getAvailableMoves(this).length||this.pieces.filter((function(i){return i.color===e&&i!==n&&i.getAvailableMoves(t).length})).length?g.Check:g.Checkmate}},{key:"pieces",get:function(){return Array.from(this.board.values())}},{key:"cells",get:function(){for(var e=[],t=this.height-1;t>=0;t--)for(var n=0;n<this.width;n++)e.push(O.fromXY(n,t));return e}},{key:"rows",get:function(){for(var e=[],t=this.height-1;t>=0;t--)e.push(O.toRow(t));return e}},{key:"columns",get:function(){for(var e=[],t=0;t<this.width;t++)e.push(O.toColumn(t));return e}}]),e}();Object(C.i)(z,{position:C.n,color:C.n});var V=z,Z=function(e){Object(E.a)(n,e);var t=Object(A.a)(n);function n(){return Object(b.a)(this,n),t.apply(this,arguments)}return Object(m.a)(n,[{key:"getAllMoves",value:function(e){var t,n=[];t=this.color===w.White?y.Up:y.Down;var i=this.position.to(t+y.Left);if(i.isOK(e)){var o=e.get(i);(null===o||void 0===o?void 0:o.isOpponent(this))&&n.push(i)}var r=this.position.to(t+y.Right);if(r.isOK(e)){var a=e.get(r);(null===a||void 0===a?void 0:a.isOpponent(this))&&n.push(r)}var c=this.position.to(t);if(c.isOK(e)){e.get(c)||n.push(c);var s=this.color===w.White?1:e.height-2;if(this.position.y===s){var u=c.to(t);if(u.isOK(e))e.get(u)||n.push(u)}}return n}},{key:"canBePromoted",value:function(e){return this.color===w.Black?0===this.position.y:this.color===w.White&&this.position.y===e.height-1}},{key:"name",get:function(){return"pawn"}}]),n}(j);Object(C.i)(Z,{position:C.n,color:C.n});var ee=Z;Object(C.i)(Q,{board:C.n,cells:C.g,pieces:C.g,put:C.f.bound,set:C.f.bound,move:C.f.bound});var te=function(){function e(t){Object(b.a)(this,e),this.board=void 0,this.boardStatus=void 0,this.currentTurn=void 0,this.winner=void 0,this.selectedPiece=void 0,this.promoting=void 0,this.board=t,this.selectedPiece=null,this.currentTurn=w.White,this.winner=null,this.boardStatus=g.None,this.promoting=null}return Object(m.a)(e,[{key:"select",value:function(e){this.isOver||(this.selectedPiece&&(this.selectedPiece.selected=!1),e?e.color===this.currentTurn&&(this.selectedPiece=e,this.selectedPiece.selected=!0):this.selectedPiece=null)}},{key:"passTurn",value:function(){this.isOver||(this.select(null),this.currentTurn=this.currentTurn===w.White?w.Black:w.White)}},{key:"move",value:function(e,t){this.board.move(e,t);var n=this.currentTurn===w.White?w.Black:w.White;this.boardStatus=this.board.checkmate(n),this.boardStatus===g.Checkmate?(this.winner=this.currentTurn,this.selectedPiece=null):this.boardStatus===g.Stalemate?this.selectedPiece=null:(this.promoting=e instanceof Z&&e.canBePromoted(this.board)?e:null,this.promoting||this.passTurn())}},{key:"promotePawn",value:function(e){if(!this.promoting)throw new Error("No pawn to promote.");var t=this.promoting,n=new e(t.position,t.color);this.board.put(n),this.promoting=null,this.passTurn()}},{key:"isOver",get:function(){return this.boardStatus===g.Checkmate||this.boardStatus===g.Stalemate}}]),e}();Object(C.i)(te,{board:C.n,selectedPiece:C.n,currentTurn:C.n,boardStatus:C.n,promoting:C.n,isOver:C.g,select:C.f.bound,passTurn:C.f.bound,move:C.f.bound,promotePawn:C.f.bound});var ne=new te(function(){for(var e=new Q,t=0;t<e.width;t++){var n=new ee(O.fromXY(t,1),w.White);e.put(n);var i=new ee(O.fromXY(t,e.height-2),w.Black);e.put(i)}var o=new V("E1",w.White);e.put(o);var r=new D("D1",w.White);e.put(r);var a=new W("B1",w.White);e.put(a);var c=new W("G1",w.White);e.put(c);var s=new R("A1",w.White);e.put(s);var u=new R("H1",w.White);e.put(u);var l=new B("C1",w.White);e.put(l);var h=new B("F1",w.White);e.put(h);var v=new V("E8",w.Black);e.put(v);var f=new D("D8",w.Black);e.put(f);var p=new W("B8",w.Black);e.put(p);var d=new W("G8",w.Black);e.put(d);var g=new R("A8",w.Black);e.put(g);var b=new R("H8",w.Black);e.put(b);var m=new B("C8",w.Black);e.put(m);var k=new B("F8",w.Black);return e.put(k),e}());var ie=Object(s.a)((function(){return r.a.createElement(J,{game:ne})}));Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));c.a.render(r.a.createElement(r.a.StrictMode,null,r.a.createElement(ie,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}],[[16,1,2]]]);
//# sourceMappingURL=main.8ba59d3c.chunk.js.map